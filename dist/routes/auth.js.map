{"version":3,"sources":["../../server/routes/auth.js"],"names":["authRouter","express","Router","post","validateUserEntry","req","res","token","validateUserSignIn","payload","jwt","sign","process","env","SECRET_KEY","header","status","send","message"],"mappings":";;;;;;AAAA;;;;AACA;;AACA;;AACA;;;;AACA;;;;;;AACA,IAAMA,aAAaC,kBAAQC,MAAR,EAAnB;;AAEAF,WAAWG,IAAX,CAAgB,SAAhB,EAA2BC,6BAA3B,EAA8C,UAACC,GAAD,EAAMC,GAAN,EAAc;AAAA,MAChDC,KADgD,GACvCF,GADuC,CAChDE,KADgD;;AAEvD,+BAAaD,GAAb,EAAkB,GAAlB,EAAsBC,KAAtB,EAA4B,IAA5B;AAEJ,CAJD;;AAMAP,WAAWG,IAAX,CAAgB,QAAhB,EAA0BK,8BAA1B,EAA8C,UAACH,GAAD,EAAKC,GAAL,EAAY;AAAA,MAClDG,OADkD,GACvCJ,GADuC,CAClDI,OADkD;;AAEzD,MAAMF,QAAQG,uBAAIC,IAAJ,CAASF,OAAT,EAAkBG,QAAQC,GAAR,CAAYC,UAA9B,CAAd;AACAR,MAAIS,MAAJ,CAAW,eAAX,cAAsCR,KAAtC;AACOD,MAAIU,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBC,aAAS,wBADU;AAEnBX;AAFmB,GAArB;AAIP,CARD;;kBAYeP,U","file":"auth.js","sourcesContent":["import express from 'express';\nimport { validateUserEntry, verifyToken, hashPassword, insertUser, validateUserSignIn } from '../helpers/validators';\nimport { sendResponse } from '../helpers/responses';\nimport jwt from \"jsonwebtoken\"\nimport insertUsers from '../crud/db'\nconst authRouter = express.Router();\n\nauthRouter.post('/signup', validateUserEntry, (req, res) => {\n     const {token} = req\n     sendResponse(res, 200,token,null)\n    \n});\n\nauthRouter.post('/login', validateUserSignIn, (req,res)=> {\n\tconst {payload} = req;\n\tconst token = jwt.sign(payload, process.env.SECRET_KEY);\n\tres.header('Authorization', `Bearer ${token}`);\n        res.status(303).send({\n          message: 'successfully logged in',\n          token,\n        });\n})\n\n\n\nexport default authRouter;\n\n\n\n\n"]}